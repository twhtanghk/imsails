<ion-header-bar class="item-input-inset">
    <button class="button button-icon button-clear ion-navicon" menu-toggle="left">
    </button>
    <h1 class='title'>
    	<icon ng-src="chat.photoUrl"
			aria-label="{{chat.fullname}}"
			otherwise="icon ion-android-person"
			ng-if="type == 'chat'">
		</icon>
		<icon ng-src="chat.photoUrl"
			aria-label="{{chat.name}}"
			otherwise="icon ion-android-people"
			ng-if="type != 'chat'">
		</icon>
    	<span>{{chat.fullname || chat.name}}</span>
    </h1>  
</ion-header-bar>
<div class="bar item-input-inset">
	<label class="item-input-wrapper">
		<i class="icon ion-search placeholder-icon"></i>
	    <input type="text" ng-model="searchText">
	</label>
</div>
<ion-content class='has-subheader'>
	<div class="card" ng-repeat="model in collection.models |msgFilter:searchText |orderBy:'-createdAt'" ng-class="model.from == me.jid ? 'left' : 'right'">
		<div class="item item-text-wrap">
			{{model.body}}
		</div>
		<div class="item item-divider">
			<span ng-if="type == 'groupchat'">{{model.from}}</span>
			<span>{{model.createdAt.toLocaleString()}}</span>
		</div>
	</div>
	<ion-infinite-scroll ng-if="collection.state.skip < collection.state.count" on-infinite="loadMore()">
	</ion-infinite-scroll>
</ion-content>
<ion-footer-bar class="item-input-inset">
	<form ng-submit="send()">
	    <label class="item-input-wrapper">
			<i class="icon ion-email placeholder-icon"></i>
		    <input type="text" ng-model="msg">
		</label>
	</form>
</ion-footer-bar>